Количество активных пользователей хранится с помощью разделяемой памяти, я правда так немного и не понял, что у меня клиент должен бесконечно отправлять операции или один раз отправил, получил результат и на этом всё. Я сделал 2 вариант, но если нужно, то могу исправить